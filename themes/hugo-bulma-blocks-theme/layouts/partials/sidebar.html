{{ with .Page }}
{{ $pageUrl:= .RelPermalink }}

<div id="hamburger-btn" onclick="toggleMenu()">Product / Overview X</div>
<div class="column is-3">
  <nav id="sidebar" class="sidebar">
    <ul class="content-wrapper">
    {{- range site.Menus.main }}
        {{ $menuItemUrl := .URL }}
        {{ $menuItemID := add "ul-" (replace .URL "/" "") }}
        {{ if .HasChildren }}
            <li {{ if eq .URL $pageUrl }} class="is-active"{{ end }}>
              <div class="has-child">
                <a href="{{ .URL }}">{{ .Pre }}{{ .Name }}</a>
                <span onclick="toggleSubMenu('{{ $menuItemID }}')" class="drop-arrow"><img src="/img/arrow.svg"/></span>
              </div>
              <ul id="{{ $menuItemID }}" class="collapsed">
                {{ range sort .Children "Weight" }}
                    {{ if .HasChildren }}
                        <li {{ if eq .URL $pageUrl }} class="is-active"{{ end }}>
                        <div class="has-child">
                            <a href="{{ .URL }}">{{ .Pre }}{{ .Name }}</a>
                            <span class="drop-arrow"><img src="/img/arrow.svg"/></span>
                        </div>
                        <ul>
                            {{ range sort .Children "Weight" }}
                            <li {{ if eq .URL $pageUrl }} class="is-active"{{ end }}>
                            <a href="{{ .URL }}">{{ .Pre }}{{ .Name }}</a>
                            </li>
                            {{ end }}
                        </ul>
                        {{ else }}
                        <li {{ if eq .URL $pageUrl }} class="is-active"{{ end }}>
                        <a href="{{ .URL }}">
                            {{ .Pre }}<span>{{ .Name }}</span>
                        </a>
                        </li>
                    {{ end }}
                {{ end }}
              </ul>
            {{ else }}
            <li {{ if eq .URL $pageUrl }} class="is-active"{{ end }}>
              <a href="{{ .URL }}">
                {{ .Pre }}<span>{{ .Name }}</span>
            </a>
            </li>
        {{ end }}
    {{- end }}
    </ul>
  </nav>
</div>
{{ end }}

<script>
function toggleSubMenu(listId) {
    document.getElementById(listId).classList.toggle("unfolded");
}

function toggleMenu() {
    document.getElementById("sidebar").classList.toggle("mobile-visible");
}
</script>
